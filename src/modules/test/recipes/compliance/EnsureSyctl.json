[
  {
    "Action": "LoadModule",
    "Module": "compliance.so"
  },
  {
    "RunCommand": "sysctl net.ipv4.conf.default.log_martians=1 && test -f /etc/sysctl.d/99-sysctl.conf && cp /etc/sysctl.d/99-sysctl.conf /etc/sysctl.d/99-sysctl.conf.bak ||  true ; echo net.ipv4.conf.default.log_martians=1 >> /etc/sysctl.d/99-sysctl.conf"
  },

  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "procedureTest",
    "Payload": {
      "audit": {
        "EnsureSysctl": {
          "sysctlName": "net.ipv4.conf.default.log_martians",
          "value": "1"
        }
      },
      "parameters": {
      }
    }
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ EnsureSysctl: Correct value for 'net.ipv4.conf.default.log_martians': '1' } == TRUE"
  },

  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "procedureTest",
    "Payload": {
      "audit": {
        "EnsureSysctl": {
          "sysctlName": "net.ipv4.conf.default.log_martians",
          "value": "0"
        }
      },
      "parameters": {
      }
    }
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "{ EnsureSysctl: Expected 'net.ipv4.conf.default.log_martians' value: '0' got '1' } == FALSE"
  },

  {
    "RunCommand": "sysctl net.ipv4.conf.default.log_martians=0 && test -f /etc/sysctl.d/99-sysctl.conf.bak && { mv /etc/sysctl.d/99-sysctl.conf.bak /etc/sysctl.d/99-sysctl.conf ; } || { rm /etc/sysctl.d/99-sysctl.conf ; }"
  },

  {
    "Action": "UnloadModule"
  }
]
