[
  {
    "Action": "LoadModule",
    "Module": "compliance.so"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "procedureTest",
    "Payload": {
      "audit": {
        "FileRegexMatch": {
          "path": "$PATH",
          "filenamePattern": "$FILENAME",
          "matchOperation": "$OPERATION",
          "matchPattern": "$PATTERN",
          "behavior": "$BEHAVIOR"
        }
      },
      "parameters": {
        "OPERATION": "pattern match",
        "PATTERN": ".*",
        "PATH": "/tmp",
        "FILENAME": "testfile",
        "BEHAVIOR": "all_exist"
      }
    }
  },
  {
    "RunCommand": "echo foo > /tmp/testfile"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },
  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATTERN=foo"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATTERN=f.*o"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATTERN=f.*O"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "{ FileRegexMatch: pattern 'f.*O' did not match line 1 in file '\/tmp\/testfile' } == FALSE"
  },

  {
    "RunCommand": "echo foooOx > /tmp/testfile"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATTERN=f.*O"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },

  {
    "RunCommand": "echo foooOx > /tmp/testfile"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },




  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATH=/etc FILENAME='^passwd$' PATTERN=^root:x:[0-9]+:[0-9]+"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "{ FileRegexMatch: pattern '^root:x:[0-9]+:[0-9]+' did not match line 2 in file '\/etc\/passwd' } == FALSE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATH=/etc FILENAME='^passwd$' PATTERN=^root:x:[0-9]+:[0-9]+$"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "{ FileRegexMatch: pattern '^root:x:[0-9]+:[0-9]+$' did not match line 1 in file '\/etc\/passwd' } == FALSE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATH=/etc FILENAME='^passwd$' PATTERN=^[^:#]+:.*"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },



  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATH=/tmp FILENAME='^passwd$' PATTERN=^[^:#]+::"
  },
  {
    "RunCommand": "echo testuser::1111:1111::/home/someuser:/bin/sh > /tmp/passwd"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },
  {
    "RunCommand": "echo '#testuser::1111:1111::/home/someuser:/bin/sh' > /tmp/passwd"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "{ FileRegexMatch: pattern '^[^:#]+::' did not match line 1 in file '\/tmp\/passwd' } == FALSE"
  },

  {
    "ObjectType": "Desired",
    "ComponentName": "Compliance",
    "ObjectName": "initTest",
    "Payload": "PATH=/tmp/non-existing-dir FILENAME='^passwd$' PATTERN=^[^:#]+:: BEHAVIOR=none_exist"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch:  } == TRUE"
  },
  {
    "RunCommand": "mkdir -p /tmp/non-existing-dir"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch: No files matched the filename pattern '^passwd$' } == TRUE"
  },
  {
    "RunCommand": "echo 'not the searched pattern' >   /tmp/non-existing-dir/passwd"
  },
  {
    "ObjectType": "Reported",
    "ComponentName": "Compliance",
    "ObjectName": "auditTest",
    "Payload": "PASS{ FileRegexMatch: pattern '^[^:#]+::' did not match line 1 in file '\/tmp\/non-existing-dir\/passwd' } == TRUE"
  },

  {
    "RunCommand": "rm -rf /tmp/non-existing-dir"
  },
  {
    "RunCommand": "rm -f /tmp/passwd"
  },
  {
    "RunCommand": "rm -f /tmp/testfile"
  },
  {
    "Action": "UnloadModule"
  }
]
