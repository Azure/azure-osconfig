{
    "modules": [
        "firewall"
    ],
    "setup": "iptables-save > /tmp/iptables.rules",
    "teardown": "iptables-restore < /tmp/iptables.rules",
    "steps": [
        {
            "type": "reported",
            "component": "invalid",
            "object": "state",
            "expect": {
                "status": 22
            }
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "invalid",
            "expect": {
                "status": 22
            }
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "state"
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "fingerprint"
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "defaultPolicies"
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "configurationStatus"
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "configurationStatusDetail"
        },
        {
            "type": "desired",
            "component": "Firewall",
            "object": "desiredDefaultPolicies",
            "payload": [
                {
                    "action": "accept",
                    "direction": "in"
                },
                {
                    "action": "accept",
                    "direction": "out"
                }
            ]
        },
        {
            "type": "desired",
            "component": "Firewall",
            "object": "desiredDefaultPolicies",
            "payload": [
                {
                    "action": "invalid",
                    "direction": "invalid"
                }
            ],
            "expect": {
                "status": 22
            }
        },
        {
            "type": "desired",
            "component": "Firewall",
            "object": "desiredRules",
            "payload": [
                {
                    "desiredState": "present",
                    "action": "accept",
                    "direction": "in",
                    "protocol": "tcp",
                    "sourcePort": 80,
                    "sourceAddress": "0.0.0.0"
                }
            ]
        },
        {
            "type": "reported",
            "component": "Firewall",
            "object": "configurationStatus",
            "expect": {
                "payload": "success",
                "status": 0
            }
        }
    ]
}